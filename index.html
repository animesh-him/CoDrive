<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CoDrive</title>

<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  min-height: 100vh;
  font-family: system-ui;
  color: #fff;
  background: linear-gradient(
    270deg,
    #f58529,
    #fd1d1d,
    #dd2a7b,
    #8134af,
    #515bd4
  );
  background-size: 1200% 1200%;
  animation: insta 2.5s linear infinite;
}

@keyframes insta {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.container {
  max-width: 420px;
  margin: auto;
  padding: 18px;
}

h1 {
  text-align: center;
  font-family: 'Pacifico', cursive;
}

/* uniform spacing block */
.block { margin-top: 14px; }

.tabs { display: flex; gap: 12px; }

.tabs button {
  flex: 1;
  padding: 12px;
  border-radius: 14px;
  border: none;
  background: black;
  color: white;
  font-size: 14px;
}

.tabs button.active { opacity: 0.8; }

.dropdown { position: relative; }

.dropdown-btn,
#slot {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  background: black;
  color: white;
  border: none;
  text-align: left;
}

.dropdown-panel {
  display: none;
  position: absolute;
  top: 105%;
  width: 100%;
  background: white;
  color: black;
  border-radius: 14px;
  max-height: 230px;
  overflow-y: auto;
  z-index: 20;
}

.dropdown-panel input {
  width: calc(100% - 20px);
  margin: 10px;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid #ccc;
}

.option {
  padding: 12px;
  cursor: pointer;
}

.option:hover { background: #eee; }

#vote {
  display: block;
  width: 100%;
  margin: 14px auto 0 auto;
  padding: 14px;
  border-radius: 14px;
  background: #e0e0e0;
  color: black;
  border: none;
  font-weight: 600;
  text-align: center;
}

.footer {
  margin-top: 42px;
  text-align: center;
  font-family: 'Pacifico', cursive;
}

.credit { animation: float 2.5s ease-in-out infinite; }

@keyframes float {
  0% { opacity: 0.6; }
  50% { opacity: 1; }
  100% { opacity: 0.6; }
}
</style>
</head>

<body>
<div class="container">

<h1>CoDrive</h1>

<div class="tabs block">
  <button class="active" id="todayBtn">Today</button>
  <button id="tomorrowBtn">Tomorrow</button>
</div>

<div class="dropdown block" id="fromDD">
  <button class="dropdown-btn">From location</button>
  <div class="dropdown-panel"></div>
</div>

<div class="dropdown block" id="toDD">
  <button class="dropdown-btn">To location</button>
  <div class="dropdown-panel"></div>
</div>

<select id="slot" class="block">
  <option selected disabled>Time slot</option>
</select>

<button id="vote" class="block">My Preference</button>

<div class="footer">
  Finding my co-driving partner!
  <div class="credit">Created by Animesh</div>
</div>

</div>

<script>
// ------------------ LOCATIONS ------------------
const locations = [
  "Bagmane Tech Park, CV Raman Nagar",
  "Boeing Office (North Bangalore)",
  "Brigade Eldorado",
  "Cubbon Park",
  "Dynamatics (North Bangalore)",
  "Ecospace (Bellandur)",
  "Electronic City",
  "ITPL (Whitefield)",
  "KARLE SEZ",
  "Kempegowda International Airport T1",
  "Kempegowda International Airport T2",
  "Koramangala",
  "Manyata Tech Park",
  "MG Road",
  "Prestige Finsbury",
  "SAP Labs (North Bangalore)",
  "Sarjapur",
  "Shell Technology Center (North Bangalore)"
].sort();

// ------------------ POPULARITY COLOR ------------------
function popularityColor(count) {
  if (count <= 1) return "#d9d9d9";
  if (count === 2) return "#b0b0b0";
  if (count === 3) return "#7a7a7a";
  if (count === 4) return "#3f3f3f";
  return "#000000";
}

// ------------------ IST DATE UTILS ------------------
function getISTDate(offsetDays=0) {
  const now = new Date();
  // Convert to UTC
  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  // Add IST offset +5:30
  const istTime = new Date(utc + 5.5*60*60*1000);
  // Add offsetDays
  istTime.setDate(istTime.getDate() + offsetDays);
  const yyyy = istTime.getFullYear();
  const mm = String(istTime.getMonth()+1).padStart(2,'0');
  const dd = String(istTime.getDate()).padStart(2,'0');
  return `${yyyy}-${mm}-${dd}`;
}

function getFutureSlots() {
  const slots = [];
  const now = new Date();
  const utc = now.getTime() + now.getTimezoneOffset() * 60000;
  const istNow = new Date(utc + 5.5*60*60*1000);
  const currentHour = istNow.getHours();
  const currentMinute = istNow.getMinutes();
  for (let h=0; h<24; h++) {
    for (let m=0; m<60; m+=30) {
      const slotStr = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
      if (h>currentHour || (h===currentHour && m>currentMinute)) {
        const nextH = m===0?h:h+1;
        const nextM = m===0?30:0;
        const slotRange = `${slotStr} - ${String(nextH).padStart(2,'0')}:${String(nextM).padStart(2,'0')}`;
        slots.push(slotRange);
      }
    }
  }
  return slots;
}

// ------------------ DROPDOWNS ------------------
function setupDropdown(id, excludeFn) {
  const dd = document.getElementById(id);
  const btn = dd.querySelector(".dropdown-btn");
  const panel = dd.querySelector(".dropdown-panel");

  btn.onclick = () => {
    panel.style.display = panel.style.display==="block"?"none":"block";
  };

  panel.innerHTML = `<input placeholder="Search..." /><div class="list"></div>`;
  const input = panel.querySelector("input");
  const list = panel.querySelector(".list");

  function render() {
    list.innerHTML="";
    locations
      .filter(l => !excludeFn(l))
      .filter(l => l.toLowerCase().includes(input.value.toLowerCase()))
      .forEach(l=>{
        const d=document.createElement("div");
        d.className="option";
        d.textContent=l;
        d.onclick=()=>{
          btn.textContent=l;
          panel.style.display="none";
          renderAll();
        };
        list.appendChild(d);
      });
  }
  input.oninput = render;
  render();
}

function renderAll() {
  setupDropdown("fromDD", l=>document.getElementById("toDD").querySelector(".dropdown-btn").textContent===l);
  setupDropdown("toDD", l=>document.getElementById("fromDD").querySelector(".dropdown-btn").textContent===l);
}

// ------------------ INITIAL SLOT ------------------
function renderSlots() {
  const slotSel=document.getElementById("slot");
  slotSel.innerHTML="";
  const futureSlots=getFutureSlots();
  futureSlots.forEach(s=>{
    const opt=document.createElement("option");
    opt.value=s;
    opt.textContent=s;
    slotSel.appendChild(opt);
  });
}

// ------------------ TABS ------------------
document.getElementById("todayBtn").onclick=()=>{
  document.getElementById("todayBtn").classList.add("active");
  document.getElementById("tomorrowBtn").classList.remove("active");
  renderSlots();
};
document.getElementById("tomorrowBtn").onclick=()=>{
  document.getElementById("tomorrowBtn").classList.add("active");
  document.getElementById("todayBtn").classList.remove("active");
  renderSlots();
};

// ------------------ INIT ------------------
renderAll();
renderSlots();
</script>
</body>
</html>
